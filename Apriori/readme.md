# 使用Apriori算法进行关联分析 #

> 商店通过会员顾客的忠诚度计划来获取顾客购买商品的相关组合信息，查看那些商品经常在一起购买，可以帮助商店了解用户的购买行为。便于商家用于商品定价，市场促销和存货管理。从大规模数据集中寻找物品间的隐含关系成为关联分析或者关联规则学习。

## 关联分析 ##

* 关联分析是一种在大数据集中寻找有趣关系的任务。这些关系可以有两种形式：频繁项集或者关联规则。  
* 频繁项集是经常出现在一起的物品的集合   
* 关联规则暗示两种物品之间可能存在很强的关系。  
* 当寻找频繁项集时，频繁项的定义中最重要的是支持度和可信度  
* 一个项集的支持度被定义为数据集中包含该项集的记录所占的比例。

## Apriori原理 ##
* 假设现在有n件商品，不考虑购买的数量重叠，消费者购买的可能组合就有2^n-1种。这2^N-1种项集组合无法全部遍历，因此通过Apriori原理过滤到不可能“频繁”出现的项集。Apriori原理指如果某个项集是频繁的，那么它的所有子集也是频繁的。实际应用时，通常对原理取反：如果一个项集是非频繁集，那么它的所有超集也都是非频繁的。Apriori意指“来自以前”，即定义问题时通常使用先验知识或者假设，例如在贝叶斯统计中使用先验知识作为条件进行推断，这些先验知识可能来自领域知识、先前的测量结果等。  
* Apriori算法通过已经得到的支持度达标的项集来构造更复杂的项集，因此可以看作迭代的过程。初始状态每个项集仅包含一个物品，通过统计这些长度为1的项集的支持度，筛选掉不达标的项集，再用达标项集生成长度为2的项集。过程不断重复直到所有的项集筛选完成。

## 示例：发现毒蘑菇的相似特征 ##

在这个例子中，寻找毒蘑菇中的一些公共特征，利用这些特征就能避免吃到那些有毒的蘑菇。UCI的机器学习数据集合中有一个关于肋形蘑菇的23种特征的数据集，每一个特征都包含了一个标称数据值，必须将这些标称值转化为一个集合。幸运的是，已经有人做好了这种转换。Roberto Bayardo对UCI蘑菇数据集进行了解析，将每个蘑菇样本转换成一个特征集合。其中，枚举了每个特征的所有可能值，如果某个样本包含特征，那么该特征对应的整数值被包含在数据集中。  

它在源数据集合中是一个名为mushroom.dat的文件

可以打开文件mushroom.dat查看

第一个特征表示有毒或者可食用。如果某样本有毒，则值为2。如果可食用，则值为1。下一个特征是蘑菇伞的形状，有六种可能的值，分别用整数3-8来表示。

* 文件mushroom.dat的每一行第一个特征用1或者2表示可食用或有毒，其余列都是某种蘑菇的特征。通过apriori算法寻找包含特征值为2的频繁项集。

当前目录下程序运行：

	import apriori
	mushDatSet = [line.split() for line in open('mushroom.dat').readlines()]
	L, suppData = apriori.apriori(mushDatSet, minSupport = 0.3)

	在结果中搜索包含有毒特征值2的频繁项集：
	for item in L[1:
		if item.intersection('2'): print item

	
![](http://i.imgur.com/vJ3YEIK.png)


	对更大的项目来重复上述过程：

	for item in L[3]:
		if item.intersection('2'): print item

![](http://i.imgur.com/43pyNKK.png)

接下来你需要观察一下这些特征，以便知道了解野蘑菇的那些方面。如果看到其中任何一个特征，那么这些蘑菇就不要吃了。
